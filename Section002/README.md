# README

本仓库提供中英文两种语言的文档说明。

- [English](#english-version)
- [Chinese](#chinese-version)

## English Version <a name="english-version"></a>

### Section002 RMSE Sorting of Single-Station S-Wave Receiver Functions

#### Operation Flow of RMSE Sorting

##### 1. RMSE Analysis
- Enter the `Section002/data/` folder and perform RMSE sorting on single-station data by running the Linux command:
  ```bash
  cd ./data/
  bash Do_RMSE.sh
  cd ../
  ```

##### Explanation of Do_RMSE.sh Script
**Function:** Preprocess the results from the GC_SRF process and perform RMSE analysis.

**Input Data:**
[For example, for station CQ.ROC]
```
/data/CQ.ROC/Good.srf.l.*sac.100.cut.rm : SAC waveforms of single-station multi-event SRFs extracted using GC_SRF, after time window cutting (-100s~100s), time sequence reversal, and moveout correction.
```

**Output Files:**
Mainly used for plotting.
```
/data/CQ.ROC/*srf : SAC data after further time sequence reversal and time window cutting (-5s~95s), which can be directly compared with conventional P-wave receiver function waveforms.
CQ.ROC.ref_sum.xy : Stacked waveforms corresponding to different SRF stacking ratios.
CQ.ROCSRF_before.xyz : XYZ grid file of SRFs before RMSE sorting, format: time, waveform number, waveform amplitude.
CQ.ROCSRF_after.xyz : XYZ grid file of SRFs after RMSE sorting, format: time, waveform number, waveform amplitude.
CQ.ROCrmse_before.xy : RMSE values arranged by waveform number before sorting.
CQ.ROCrmse_after.xy : RMSE values arranged by waveform number after sorting.
```

**Note:** This script uses silent running of octave, which needs to be installed in advance. If you have created a conda environment using GCSRF.yml, no additional installation is needed.

Installation commands for Ubuntu/WSL: `sudo apt install octave-signal`  
For Anaconda/miniconda: `conda install -c conda-forge octave`  
For macOS Homebrew: `brew install octave`  
For macOS App Bundles, see: [Octave App Releases](https://github.com/octave-app/octave-app/releases)

##### 2. Plotting RMSE Analysis Results
- In the `Section002` folder, run the Linux command:
  ```bash
  bash ./Plot_RMSE.sh CQ.ROC
  ```
  The resulting figures are placed in the `figs` folder, as shown:
  ![RMSE 001](./figs/CQ.ROC.Fig07.rmse.jpg)

- Similarly, for station SC.MGU:
  ```bash
  bash ./Plot_RMSE.sh SC.MGU
  ```
  The resulting figures are placed in the `figs` folder, as shown:
  ![RMSE 002](./figs/SC.MGU.Fig07.rmse.jpg)

#### Necessary Tools and Libraries

##### Linux
1. GMT 6
2. SAC
3. Taup
4. octave

## Chinese Version <a name="chinese-version"></a>

### Section002 单台S波接收函数的RMSE排序

#### RMSE排序的操作流程

##### 1. RMSE分析
- 进入Section002/data/文件夹中,对单台数据进行RMSE排序操作,linux执行命令
```bash
cd ./data/
bash Do_RMSE.sh
cd ../
```

##### Do_RMSE.sh脚本说明
功能: 对GC_SRF流程计算结果进行预处理,并开展RMSE分析

**输入数据 :**
[ 以CQ.ROC台站为例 ]
```
/data/CQ.ROC/Good.srf.l.*sac.100.cut.rm : 台站CQ.ROC使用GC_SRF提取得到单台多事件SRF经过时窗截取(-100s~100s)、时序翻转、moveout校正后的SAC波形
```

**输出文件:**
输出文件主要用于绘图展示.
```
/data/CQ.ROC/*srf : 输入SAC数据经过再次时序翻转和时窗截取(-5s~95s),该文件可与常规的P波接收函数波形进行直接对比.
CQ.ROC.ref_sum.xy :  不同SRF叠加比例对应的叠加波形 
CQ.ROCSRF_before.xyz : RMSE排序前SRF xyz网格文件,格式:时间,波形序号,波形振幅
CQ.ROCSRF_after.xyz : RMSE排序后SRF xyz网格文件,格式:时间,波形序号,波形振幅
CQ.ROCrmse_before.xy : 排序前随波形序号排列的RMSE值
CQ.ROCrmse_after.xy : 排序后随波形序号排列的RMSE值 
```

**PS:** 该脚本中使用了octave的静默运行,需提前安装,如果已使用GCSRF.yml创建conda环境则无需额外安装.

Ubuntu/WSL平台安装命令为```sudo apt install octave-signal```  
Anaconda/miniconda平台安装命令为```conda install -c conda-forge octave ```  
macOS Homebrew安装命令为```brew install octave```  
macOS App Bundles安装包见 https://github.com/octave-app/octave-app/releases

##### 2. RMSE分析结果绘图
- 在Section002文件夹中,linux执行命令   
```bash
bash ./Plot_RMSE.sh CQ.ROC
```
结果图件放置于figs文件夹中,图件如下:   
![RMSE 001](./figs/CQ.ROC.Fig07.rmse.jpg)     

- 在Section002文件夹中,linux执行命令   
```bash
bash ./Plot_RMSE.sh SC.MGU
```
结果图件放置于figs文件夹中,图件如下:
![RMSE 002](./figs/SC.MGU.Fig07.rmse.jpg)   

#### 必要工具和库
##### Linux
1. GMT 6
2. SAC
3. Taup
4. octave

---

```
This bilingual README was generated by Grok 3.
此双语 README 由 Grok 3 生成。
```
